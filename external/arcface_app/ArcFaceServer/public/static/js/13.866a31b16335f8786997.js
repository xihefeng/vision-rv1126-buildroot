webpackJsonp([13],{BfaP:function(e,t){},MxJJ:function(e,t){},VIxT:function(e,t,a){"use strict";var n={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"topBar"},[this._t("top-content")],2)},staticRenderFns:[]};var s=a("VU/8")({name:"",data:function(){return{}}},n,!1,function(e){a("MxJJ")},"data-v-01fba590",null);t.a=s.exports},XVPy:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("BO1k"),s=a.n(n),o={name:"accountManagement",data:function(){var e=this.$createElement;return{page:1,total:0,roleList:[],accountList:[],admin:!0,adminAccount:!0,form:this.$form.createForm(this,{name:"add-account"}),downIcon:e("span",{class:"iconfont iconziyuan4"}),addAccountModal:!1,resetModal:!1,deleteModal:!1,changeModal:!1,successMessageModal:!1,changeSuccessModal:!1,confirmDirty:!1,oldPwdWrong:!1,currentAccount:{},addFailModal:!1,deleteTitle:" "}},computed:{columns:function(){var e=this;return[{title:this.$t("accountManagement.index"),customRender:function(t,a,n){return""+(n+1+24*(e.page-1))}},{title:this.$t("accountManagement.createTime"),dataIndex:"createTime",key:"createTime"},{title:this.$t("accountManagement.accountName"),dataIndex:"accountName",key:"accountName"},{title:this.$t("accountManagement.roleName"),dataIndex:"roleName",key:"roleName"},{title:this.$t("accountManagement.action"),key:"action",scopedSlots:{customRender:"action"}}]},requireMessage:function(){return this.$t("accountManagement.required")},pwdMsg:function(){return this.$t("accountManagement.pwdMsg")},addTitle:function(){return this.$t("accountManagement.addTitle")},resetTitle:function(){return this.$t("accountManagement.resetPwd")},changeTitle:function(){return this.$t("accountManagement.changePwd")},confirmPwd2:function(){return this.$t("accountManagement.confirmPwd2")},newPwdPlaceholder:function(){return this.$t("accountManagement.newPwdPlaceholder")},oldPwdPlaceholder:function(){return this.$t("accountManagement.oldPwdPlaceholder")},accountPlaceholder:function(){return this.$t("accountManagement.accountPlaceholder")},pwdPlaceholder:function(){return this.$t("accountManagement.pwdPlaceholder")},rolePlaceholder:function(){return this.$t("accountManagement.rolePlaceholder")}},components:{TopBar:a("VIxT").a},mounted:function(){this.isAdmin(),this.getAllAccount()},methods:{isAdmin:function(){var e=this.$store.state.username;this.$store.state.rolename.toLowerCase()!=="Admin".toLowerCase()?this.admin=!1:this.getAllRole(),e.toLowerCase()!=="Admin".toLowerCase()&&(this.adminAccount=!1)},oldPwdChange:function(){this.oldPwdWrong=!1},handlePageChange:function(){},getAllRole:function(){var e=this;this.$axios.get("getAllRoles").then(function(t){if(0===t.data.retCode)for(var a=t.data.info,n=0;n<a.length;n++){var s={roleId:a[n].roleId,roleName:a[n].roleName};e.roleList.push(s)}})},getAllAccount:function(){this.accountList=[];var e=this;this.$axios.get("getAllAccounts").then(function(t){if(0===t.data.retCode){var a=t.data.info;if(e.admin){var n=!0,o=!1,r=void 0;try{for(var c,i=s()(a);!(n=(c=i.next()).done);n=!0){var l=c.value;l.createTime=e.$utils.getDate(l.createTime,!0),l.roleName.toLowerCase()==="Admin".toLowerCase()&&(l.roleName="Admin")}}catch(e){o=!0,r=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw r}}e.accountList=a}else{var d=e.$store.state.username,u=!0,m=!1,g=void 0;try{for(var h,v=s()(a);!(u=(h=v.next()).done);u=!0){var f=h.value;f.accountName===d&&(f.createTime=e.$utils.getDate(f.createTime,!0),e.accountList.push(f))}}catch(e){m=!0,g=e}finally{try{!u&&v.return&&v.return()}finally{if(m)throw g}}}e.total=t.data.total}})},addAccount:function(){this.addAccountModal=!0},handleAddOk:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,a){if(!e){var n=t;t.$axios.patch("createAccount",{accountName:a.accountName,accountPassword:a.password,roleId:parseInt(a.role)}).then(function(e){0===e.data.retCode?(n.addAccountModal=!1,n.getAllAccount()):"AccountName already exists."===e.data.retMsg&&(n.addAccountModal=!1,n.addFailModal=!0,setTimeout(function(){n.addFailModal=!1},3e3))})}})},handleAddCancel:function(e){this.addAccountModal=!1},reset:function(e){this.currentAccount=e,this.resetModal=!0},handleResetOk:function(){var e=this;this.form.validateFields(function(t,a){if(!t){var n=e;e.$axios.patch("resetPassword",{accountId:n.currentAccount.accountId,accountPassword:a.password}).then(function(e){n.currentAccount={},0===e.data.retCode&&(n.resetModal=!1,n.getAllAccount(),n.successMessageModal=!0,setTimeout(function(){n.successMessageModal=!1},3e3))})}})},handleResetCancel:function(){this.currentAccount={},this.resetModal=!1},handleConfirmBlur:function(e){var t=e.target.value;this.confirmDirty=this.confirmDirty||!!t},compareToFirstPassword:function(e,t,a){var n=this.form;t&&t!==n.getFieldValue("password")?a(this.$t("accountManagement.inconsistentPwd")):a()},changeCompareToFirstPassword:function(e,t,a){var n=this.form;t&&t!==n.getFieldValue("newPassword")?a(this.$t("accountManagement.inconsistentPwd")):a()},validateToNextPassword:function(e,t,a){var n=this.form;t&&this.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()},deleteAccount:function(e){this.currentAccount=e,this.deleteModal=!0},handleDeleteOk:function(){var e=this;this.$axios.patch("deleteAccount",{id:this.currentAccount.accountId}).then(function(t){e.currentAccount={},0===t.data.retCode&&(e.deleteModal=!1,e.getAllAccount())})},handleDeleteCancel:function(e){this.currentAccount={},this.deleteModal=!1},change:function(e){this.currentAccount=e,this.changeModal=!0},handleChangeOk:function(){var e=this;this.form.validateFields(function(t,a){if(!t){console.log("Received values of form: ",a);var n=a.oldPassword+e.currentAccount.salt;if((n=e.$md5(n))!==e.currentAccount.accountPassword)e.oldPwdWrong=!0;else{e.oldPwdWrong=!1;var s=e;e.$axios.patch("resetPassword",{accountId:e.currentAccount.accountId,accountPassword:a.newPassword}).then(function(e){s.currentAccount={},0===e.data.retCode&&(s.changeModal=!1,s.getAllAccount(),s.changeSuccessModal=!0,setTimeout(function(){s.changeSuccessModal=!1},3e3))})}}})},handleChangeCancel:function(){this.currentAccount={},this.changeModal=!1,this.oldPwdWrong=!1}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"account-management"},[e.admin?a("top-bar",{staticClass:"top"},[a("div",{staticClass:"addAccount",attrs:{slot:"top-content"},on:{click:e.addAccount},slot:"top-content"},[a("span",{staticClass:"iconfont iconzhuce"}),e._v("\n      "+e._s(e.$t("accountManagement.addAccount"))+"\n    ")])]):e._e(),e._v(" "),a("div",{staticClass:"list-content",class:{paddingTop24:!e.admin}},[a("a-table",{attrs:{"row-key":"accountId",columns:e.columns,"data-source":e.accountList,pagination:!1,tableLayout:"fixed",align:"center",rowClassName:function(e,t){var a="light-row";return t%2==1&&(a="dark-row"),a}},scopedSlots:e._u([{key:"action",fn:function(t,n){return[a("span",{staticClass:"action",attrs:{slot:"action"},slot:"action"},[e.admin||e.adminAccount?e.admin?a("div",[n.accountName.toLowerCase()!=="Admin".toLowerCase()?a("div",[n.accountName.toLowerCase()!==e.$store.state.username.toLowerCase()?a("div",[a("span",{staticClass:"reset",on:{click:function(t){return e.reset(n)}}},[e._v(e._s(e.$t("accountManagement.resetPwd")))]),e._v(" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "),a("span",{staticClass:"delete",on:{click:function(t){return e.deleteAccount(n)}}},[e._v(e._s(e.$t("accountManagement.delete")))])],1):a("div",[a("span",{staticClass:"reset",on:{click:function(t){return e.reset(n)}}},[e._v(e._s(e.$t("accountManagement.resetPwd")))])])]):e._e()]):e._e():a("div",[a("span",{staticClass:"change",on:{click:function(t){return e.change(n)}}},[e._v(e._s(e.$t("accountManagement.changePwd")))])])])]}}])})],1),e._v(" "),a("a-modal",{attrs:{destroyOnClose:!0,title:e.addTitle,visible:e.addAccountModal,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary"},on:{click:e.handleAddOk}},[e._v("\n        "+e._s(e.$t("accountManagement.open"))+"\n      ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleAddCancel}},[e._v("\n        "+e._s(e.$t("accountManagement.cancel"))+"\n      ")])],1),e._v(" "),a("a-form",{staticClass:"role-add",attrs:{form:e.form},on:{submit:e.handleAddOk}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["accountName",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur"}],expression:"[\n            'accountName',\n            {\n              rules: [{ required: true, message: requireMessage }],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{placeholder:e.accountPlaceholder,maxLength:30}})],1),e._v(" "),a("span",{staticClass:"tip"},[e._v(e._s(e.$t("accountManagement.pwdValidMsg")))]),e._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:e.requireMessage},{pattern:/^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,message:e.pwdMsg}],validateTrigger:"blur"}],expression:"[\n            'password',\n            {\n              rules: [\n                { required: true, message: requireMessage },\n                {\n                  pattern: /^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,\n                  message: pwdMsg,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{placeholder:e.pwdPlaceholder,type:"password",maxLength:30}})],1),e._v(" "),a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["role",{rules:[{required:!0,message:e.requireMessage}]}],expression:"[\n            'role',\n            {\n              rules: [{ required: true, message: requireMessage }],\n            },\n          ]"}],attrs:{suffixIcon:e.downIcon,placeholder:e.rolePlaceholder}},e._l(e.roleList,function(t,n){return a("a-select-option",{key:n,attrs:{value:t.roleId}},[e._v("\n            "+e._s(t.roleName)+"\n          ")])}),1)],1)],1)],2),e._v(" "),a("a-modal",{staticClass:"registerSuccess",attrs:{destroyOnClose:!0,visible:e.successMessageModal,centered:!0,closable:!1,width:182,footer:null}},[a("div",{staticClass:"resetContent"},[a("span",{staticClass:"iconfont iconziyuan2"}),e._v(" "),a("div",[e._v(e._s(e.$t("accountManagement.resetOk")))])])]),e._v(" "),a("a-modal",{staticClass:"registerSuccess",attrs:{destroyOnClose:!0,visible:e.changeSuccessModal,centered:!0,closable:!1,width:182,footer:null}},[a("div",{staticClass:"resetContent"},[a("span",{staticClass:"iconfont iconziyuan2"}),e._v(" "),a("div",[e._v(e._s(e.$t("accountManagement.changeOk")))])])]),e._v(" "),a("a-modal",{staticClass:"resetPwd",class:{en:"en_US"===e.$store.state.language},attrs:{destroyOnClose:!0,title:e.resetTitle,visible:e.resetModal,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary"},on:{click:e.handleResetOk}},[e._v("\n        "+e._s(e.$t("accountManagement.reset"))+"\n      ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleResetCancel}},[e._v("\n        "+e._s(e.$t("accountManagement.cancel"))+"\n      ")])],1),e._v(" "),a("a-form",{staticClass:"resetPwd",attrs:{form:e.form},on:{submit:e.handleResetOk}},[a("a-form-item",{staticClass:"newPwd"},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:e.requireMessage},{pattern:/^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,message:e.pwdMsg},{validator:e.validateToNextPassword}],validateTrigger:"blur"}],expression:"[\n            'password',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: requireMessage,\n                },\n                {\n                  pattern: /^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,\n                  message: pwdMsg,\n                },\n                {\n                  validator: validateToNextPassword,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{type:"password",placeholder:e.newPwdPlaceholder,maxLength:30}}),e._v(" "),a("span",{staticClass:"tip"},[e._v(e._s(e.$t("accountManagement.pwdValidMsg")))])],1),e._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirm",{rules:[{required:!0,message:e.requireMessage},{validator:e.compareToFirstPassword}],validateTrigger:"blur"}],expression:"[\n            'confirm',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: requireMessage,\n                },\n\n                {\n                  validator: compareToFirstPassword,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{type:"password",placeholder:e.confirmPwd2,maxLength:30},on:{blur:e.handleConfirmBlur}})],1)],1)],2),e._v(" "),a("a-modal",{attrs:{destroyOnClose:!0,title:e.deleteTitle,visible:e.deleteModal,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary"},on:{click:e.handleDeleteOk}},[e._v("\n        "+e._s(e.$t("accountManagement.confirm"))+"\n      ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleDeleteCancel}},[e._v("\n        "+e._s(e.$t("accountManagement.cancel"))+"\n      ")])],1),e._v(" "),a("div",{staticClass:"content"},[a("span",{staticClass:"iconfont iconziyuan13"}),e._v(" "),a("div",{staticClass:"p2"},[e._v(e._s(e.$t("accountManagement.confirmDeleteAccount")))])])],2),e._v(" "),a("a-modal",{staticClass:"changePwd",attrs:{destroyOnClose:!0,title:e.changeTitle,visible:e.changeModal,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary"},on:{click:e.handleChangeOk}},[e._v("\n        "+e._s(e.$t("accountManagement.confirm"))+"\n      ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleChangeCancel}},[e._v("\n        "+e._s(e.$t("accountManagement.cancel"))+"\n      ")])],1),e._v(" "),a("a-form",{staticClass:"role-add",attrs:{form:e.form},on:{submit:e.handleChangeOk}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["oldPassword",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur"}],expression:"[\n            'oldPassword',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: requireMessage,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],class:{wrong:e.oldPwdWrong},attrs:{type:"password",placeholder:e.oldPwdPlaceholder,maxLength:30},on:{change:e.oldPwdChange}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.oldPwdWrong,expression:"oldPwdWrong"}],staticClass:"oldPwdWrong"},[e._v(e._s(e.$t("accountManagement.oldPwdWrong")))])],1),e._v(" "),a("span",{staticClass:"tip"},[e._v(e._s(e.$t("accountManagement.pwdValidMsg")))]),e._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["newPassword",{rules:[{required:!0,message:e.requireMessage},{pattern:/^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,message:e.pwdMsg},{validator:e.validateToNextPassword}],validateTrigger:"blur"}],expression:"[\n            'newPassword',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: requireMessage,\n                },\n                {\n                  pattern: /^(?=.*[0-9].*)(?=.*[A-Z].*)(?=.*[a-z].*).{6,8}$/,\n                  message: pwdMsg,\n                },\n                {\n                  validator: validateToNextPassword,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{type:"password",placeholder:e.newPwdPlaceholder,maxLength:30}}),e._v(" "),a("span",{staticClass:"tip"},[e._v(e._s(e.$t("accountManagement.pwdValidMsg")))])],1),e._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirm",{rules:[{required:!0,message:e.requireMessage},{validator:e.changeCompareToFirstPassword}],validateTrigger:"blur"}],expression:"[\n            'confirm',\n            {\n              rules: [\n                {\n                  required: true,\n                  message: requireMessage,\n                },\n\n                {\n                  validator: changeCompareToFirstPassword,\n                },\n              ],\n              validateTrigger: 'blur',\n            },\n          ]"}],attrs:{type:"password",placeholder:e.confirmPwd2,maxLength:30},on:{blur:e.handleConfirmBlur}})],1)],1)],2),e._v(" "),a("a-modal",{staticClass:"addFail",attrs:{visible:e.addFailModal,centered:!0,closable:!1,width:288,footer:null}},[a("div",{staticClass:"addContent"},[a("span",{staticClass:"iconfont iconziyuan13"}),e._v(" "),a("div",[e._v(e._s(e.$t("accountManagement.accountExit")))])])])],1)},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(e){a("BfaP")},"data-v-48c4d020",null);t.default=c.exports}});