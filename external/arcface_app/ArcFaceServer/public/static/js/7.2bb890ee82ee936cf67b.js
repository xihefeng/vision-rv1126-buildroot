webpackJsonp([7],{"/tRz":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Xxa5"),r=i.n(n),a=i("exGp"),o=i.n(a),s={name:"wifiSettings",beforeCreate:function(){this.form=this.$form.createForm(this,{name:"wifiSettings"})},data:function(){return{submitLoading:!1,scanLoading:!1,deleteLoading:!1,wifiList:[],wifiDisabled:!1,autoDisabled:!1,linkLoading:!1,nameDisabled:!1,rowId:null,linkedName:"",linkedPassword:"",errIds:[],linkingWifiName:"",linkWifiOldState:"",connectLoading:!1,deleteComfirm:!1,confirmLoading:!1,showTip:!1}},computed:{columns:function(){return[{title:this.$t("wifiSettings.index"),customRender:function(t,e,i){return""+(i+1)}},{title:this.$t("wifiSettings.wifiname"),customRender:function(t,e,i){return e.wifiName}},{title:this.$t("wifiSettings.strength"),customRender:function(t,e,i){return e.strength}},{title:this.$t("wifiSettings.security"),customRender:function(t,e,i){return e.security}},{title:this.$t("wifiSettings.state"),customRender:function(t,e,i){return e.state}}]},openWifiLabel:function(){return this.$t("wifiSettings.openWifiLabel")},wifiListLabel:function(){return this.$t("wifiSettings.wifiListLabel")},spinTip:function(){return this.$t("wifiSettings.spinTip")},WIFINameLabel:function(){return this.$t("wifiSettings.WIFINameLabel")},WIFIPasswordLabel:function(){return this.$t("wifiSettings.WIFIPasswordLabel")},deleteTitle:function(){return this.$t("wifiSettings.deleteTitle")},requireMessage:function(){return this.$t("wifiSettings.required")}},mounted:function(){this.scanWifi(!0)},methods:{handleDelete:function(){this.deleteComfirm=!0},handleDeleteOk:function(){var t=this;this.confirmLoading=!0;var e=this.form.getFieldValue("WIFIName");this.$axios.patch("connectWifi",{enable:0,wifiName:e}).then(function(e){t.confirmLoading=!1,t.deleteComfirm=!1,setTimeout(function(){t.scanWifi()},1e3),t.form.setFieldsValue({WIFIName:"",WIFIPassword:""})})},handleDeleteCancel:function(){this.deleteComfirm=!1},handleSubmit:function(){var t=this;this.form.validateFields(function(e,i){e||(t.connectLoading=!0,t.linkingWifiName=i.WIFIName,t.wifiList.forEach(function(e){e.wifiName===i.WIFIName&&(t.linkWifiOldState=e.state)}),t.submitLoading=!0,t.$axios.patch("connectWifi",{enable:1,autoConnect:1,wifiName:i.WIFIName,password:i.WIFIPassword}).then(function(e){0===e.data.retCode&&(t.submitLoading=!1,t.scanLoading=!0,t.startTime=Date.now(),t.timer=setInterval(o()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.scanLoading=!1,e.next=3,t.scanWifi(!1,i.WIFIName);case 3:case"end":return e.stop()}},e,t)})),3e3))}))})},toggleOpen:function(t){this.toggleWifi(t)},toggleWifi:function(t){var e=this;this.$nextTick(function(){var i=e.form.getFieldValue("openWifi"),n=new FormData,r=t||!0===i?1:0;n.append("enable",r),e.$axios.post("enableWifi",n).then(function(){t?(e.scanLoading=!0,setTimeout(function(){e.scanWifi(),e.scanLoading=!1},3e3)):e.wifiList=[]}),e.wifiDisabled=!e.wifiDisabled})},scanWifi:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log(e,i),this.nameDisabled=!1,!0!==e&&(this.scanLoading=!0),this.$axios.get("detectWifi").then(function(n){if(0===n.data.retCode&&(t.scanLoading=!1,e&&(t.form.setFieldsValue({openWifi:1===n.data.info.wifiStatus}),t.wifiDisabled=!(1===n.data.info.wifiStatus)),!t.wifiDisabled)){var r=n.data.info.wifiService;r=r&&r.filter(function(t){return""!=t.wifiName}),t.wifiList=r;var a=r[0].service,o=r[0].wifiName;if(t.$axios.patch("getCurWifiInfo",{service:a}).then(function(e){0===e.data.retCode&&(t.form.setFieldsValue({WIFIName:o,WIFIPassword:e.data.info.password}),t.canScanLoading=1===e.data.info.autoConnect,t.showTip="ready"===r[0].state)}),t.startTime&&Date.now()-t.startTime>1e4?(t.startTime=null,t.connectLoading=!1,clearInterval(t.timer),t.$message.destroy(),t.$message.error(i+t.$t("wifiSettings.connectFail"))):t.wifiList&&t.wifiList.forEach(function(e){e.wifiName===t.linkingWifiName&&e.state!=t.linkWifiOldState&&(t.connectLoading=!1,clearInterval(t.timer))}),t.rowId=null,t.errIds=[],r)for(var s=0;s<r.length;s++)"ready"!==r[s].state&&"idle"!==r[s].state&&t.errIds.push(s)}})},autoChange:function(t){this.autoDisabled=t},rowClick:function(t,e){var i=this;return{on:{click:function(){i.showTip="ready"===t.state;var n=i;i.$axios.patch("getCurWifiInfo",{service:t.service}).then(function(e){0===e.data.retCode&&n.form.setFieldsValue({WIFIName:t.wifiName,WIFIPassword:e.data.info.password})}),i.nameDisabled=!0,i.rowId=e,i.setRowClassName()}}}},setRowClassName:function(t,e){var i="light-row";return e%2==1&&(i="dark-row"),this.errIds.includes(e)&&(i+=" errRow"),t&&"ready"==t.state&&e===this.rowId?i+=" selectedRow":t&&"ready"==t.state?i+=" linkedRow":e===this.rowId&&(i+=" selectedRow"),i},beforeDestroyed:function(){clearInterval(this.timer)}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("a-form",{staticClass:"wifiSettings",attrs:{labelAlign:"left",form:t.form,hideRequiredMark:!0},on:{submit:t.handleSubmit}},[i("a-form-item",{staticClass:"bottom24",attrs:{label:t.openWifiLabel}},[i("a-switch",{directives:[{name:"decorator",rawName:"v-decorator",value:["openWifi",{valuePropName:"checked"}],expression:"[\n          'openWifi',\n          {\n            valuePropName: 'checked',\n          },\n        ]"}],staticClass:"switch",on:{change:t.toggleOpen}})],1),t._v(" "),i("a-form-item",{staticClass:"bottom24",attrs:{label:t.wifiListLabel}},[i("a-button",{staticClass:"setBtn",attrs:{disabled:t.wifiDisabled,loading:t.connectLoading},on:{click:t.scanWifi}},[t._v(t._s(t.$t("wifiSettings.scan")))])],1),t._v(" "),t.scanLoading?i("div",{staticClass:"loading scanWifi"},[i("a-spin",{attrs:{tip:t.spinTip,size:"large"}})],1):i("a-table",{staticClass:"scanWifi",attrs:{columns:t.columns,"data-source":t.wifiList,pagination:!1,tableLayout:"fixed","row-key":"wifiName",align:"center",rowClassName:t.setRowClassName,customRow:t.rowClick},scopedSlots:t._u([{key:"name",fn:function(e){return i("a",{},[t._v(t._s(e))])}}])}),t._v(" "),i("a-form-item",{staticClass:"toRight bottom24",attrs:{label:t.WIFINameLabel}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["WIFIName",{rules:[{required:!0,message:t.requireMessage}],validateTrigger:"blur"}],expression:"[\n          'WIFIName',\n          {\n            rules: [\n              {\n                required: true,\n                message: requireMessage,\n              },\n            ],\n            validateTrigger: 'blur',\n          },\n        ]"}],attrs:{disabled:t.wifiDisabled||t.nameDisabled,maxLength:50}})],1),t._v(" "),i("a-form-item",{staticClass:"toRight bottom24",attrs:{label:t.WIFIPasswordLabel}},[i("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["WIFIPassword",{rules:[{required:!0,message:t.requireMessage}],validateTrigger:"blur"}],expression:"[\n          'WIFIPassword',\n          {\n            rules: [\n              {\n                required: true,\n                message: requireMessage,\n              },\n            ],\n            validateTrigger: 'blur',\n          },\n        ]"}],attrs:{disabled:t.wifiDisabled,maxLength:50}})],1),t._v(" "),t.showTip?i("div",{staticClass:"showTip"},[t._v("\n      "+t._s(t.$t("wifiSettings.connectedTip"))+"\n    ")]):t._e(),t._v(" "),i("a-form-item",{staticClass:"top64",attrs:{label:" ",colon:!1}},[i("a-button",{staticClass:"btn",attrs:{disabled:t.wifiDisabled,type:"primary",loading:t.submitLoading},on:{click:t.handleSubmit}},[t._v("\n        "+t._s(t.$t("wifiSettings.connect"))+"\n      ")]),t._v(" "),i("a-button",{staticClass:"deleteBtn",attrs:{loading:t.deleteLoading,disabled:t.wifiDisabled},on:{click:t.handleDelete}},[t._v("\n        "+t._s(t.$t("wifiSettings.delete"))+"\n      ")])],1)],1),t._v(" "),i("a-modal",{attrs:{title:t.deleteTitle,visible:t.deleteComfirm,centered:!0,closable:!1,width:290}},[i("template",{slot:"footer"},[i("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary",loading:t.confirmLoading},on:{click:t.handleDeleteOk}},[t._v("\n        "+t._s(t.$t("wifiSettings.confirm"))+"\n      ")]),t._v(" "),i("a-button",{key:"back",staticClass:"modal-cancel",attrs:{disabled:t.confirmLoading},on:{click:t.handleDeleteCancel}},[t._v("\n        "+t._s(t.$t("wifiSettings.cancel"))+"\n      ")])],1),t._v(" "),i("div",{staticClass:"content"},[i("span",{staticClass:"iconfont iconziyuan13"}),t._v(" "),i("div",{staticClass:"p1"},[t._v(t._s(t.$t("wifiSettings.deleteTip")))])])],2)],1)},staticRenderFns:[]};var l=i("VU/8")(s,c,!1,function(t){i("ubmg")},"data-v-100bcb69",null);e.default=l.exports},SldL:function(t,e){!function(e){"use strict";var i,n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag",l="object"==typeof t,u=e.regeneratorRuntime;if(u)l&&(t.exports=u);else{(u=e.regeneratorRuntime=l?t.exports:{}).wrap=b;var f="suspendedStart",d="suspendedYield",h="executing",m="completed",g={},p={};p[o]=function(){return this};var w=Object.getPrototypeOf,v=w&&w(w($([])));v&&v!==n&&r.call(v,o)&&(p=v);var y=_.prototype=I.prototype=Object.create(p);x.prototype=y.constructor=_,_.constructor=x,_[c]=x.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(y),t},u.awrap=function(t){return{__await:t}},W(N.prototype),N.prototype[s]=function(){return this},u.AsyncIterator=N,u.async=function(t,e,i,n){var r=new N(b(t,e,i,n));return u.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},W(y),y[c]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},u.values=$,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=i)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=i),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;k(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:$(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=i),g}}}function b(t,e,i,n){var r=e&&e.prototype instanceof I?e:I,a=Object.create(r.prototype),o=new C(n||[]);return a._invoke=function(t,e,i){var n=f;return function(r,a){if(n===h)throw new Error("Generator is already running");if(n===m){if("throw"===r)throw a;return T()}for(i.method=r,i.arg=a;;){var o=i.delegate;if(o){var s=F(o,i);if(s){if(s===g)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===f)throw n=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=h;var c=L(t,e,i);if("normal"===c.type){if(n=i.done?m:d,c.arg===g)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(n=m,i.method="throw",i.arg=c.arg)}}}(t,i,o),a}function L(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}function I(){}function x(){}function _(){}function W(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function N(t){var e;this._invoke=function(i,n){function a(){return new Promise(function(e,a){!function e(i,n,a,o){var s=L(t[i],t,n);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,a,o)},function(t){e("throw",t,a,o)}):Promise.resolve(l).then(function(t){c.value=t,a(c)},o)}o(s.arg)}(i,n,e,a)})}return e=e?e.then(a,a):a()}}function F(t,e){var n=t.iterator[e.method];if(n===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=i,F(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=L(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,g;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=i),e.delegate=null,g):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function $(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=i,e.done=!0,e};return a.next=a}}return{next:T}}function T(){return{value:i,done:!0}}}(function(){return this}()||Function("return this")())},Xxa5:function(t,e,i){t.exports=i("jyFz")},exGp:function(t,e,i){"use strict";e.__esModule=!0;var n,r=i("//Fk"),a=(n=r)&&n.__esModule?n:{default:n};e.default=function(t){return function(){var e=t.apply(this,arguments);return new a.default(function(t,i){return function n(r,o){try{var s=e[r](o),c=s.value}catch(t){return void i(t)}if(!s.done)return a.default.resolve(c).then(function(t){n("next",t)},function(t){n("throw",t)});t(c)}("next")})}}},jyFz:function(t,e,i){var n=function(){return this}()||Function("return this")(),r=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,a=r&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=i("SldL"),r)n.regeneratorRuntime=a;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}},ubmg:function(t,e){}});