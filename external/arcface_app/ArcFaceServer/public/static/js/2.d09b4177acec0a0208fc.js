webpackJsonp([2],{MxJJ:function(e,t){},UPZv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),n=a.n(i),l={name:"roleManagement",data:function(){var e=this.$createElement;return{page:1,total:0,roleList:[],authorityList:[],pageSize:24,visible:!1,deleteModal:!1,updateVisible:!1,deleteFailModal:!1,updateFailModal:!1,confirmLoading:!1,form:this.$form.createForm(this,{name:"add-role"}),downIcon:e("span",{class:"iconfont iconziyuan4"}),deleteTitle:" ",initialLimit:[],initialRoleName:"",currentRole:{}}},computed:{columns:function(){var e=this;return[{title:this.$t("roleManagement.index"),customRender:function(t,a,i){return""+(i+1+24*(e.page-1))}},{title:this.$t("roleManagement.createTime"),dataIndex:"roleCreateTime",key:"roleCreateTime",ellipsis:!0},{title:this.$t("roleManagement.roleName"),dataIndex:"roleName",key:"roleName",ellipsis:!0},{title:this.$t("roleManagement.authorityName"),dataIndex:"authorityName",key:"authorityName",ellipsis:!0,scopedSlots:{customRender:"authority"}},{title:this.$t("roleManagement.action"),key:"action",scopedSlots:{customRender:"action"}}]},Title:function(){return this.$t("roleManagement.roleMsgTitle")},requireMessage:function(){return this.$t("roleManagement.required")},rolenamePlaceholder:function(){return this.$t("roleManagement.rolename")},chooseLimit:function(){return this.$t("roleManagement.chooseLimit")}},components:{TopBar:a("VIxT").a},mounted:function(){this.getAllRole(),this.getAllAuthorities()},methods:{addRole:function(){this.visible=!0},handleOk:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,a){if(!e){var i=t;t.$axios.patch("createRole",{roleName:a.roleName,authorityIds:a.limit}).then(function(e){0===e.data.retCode?(i.visible=!1,i.getAllRole()):"RoleName already exists."===e.data.retMsg&&(i.visible=!1,i.updateFailModal=!0,setInterval(function(){i.updateFailModal=!1},3e3))})}})},handleCancel:function(e){this.currentRole={},this.visible=!1},updateRole:function(e,t){this.currentRole=t;var a=[],i="",l=!0,o=!1,r=void 0;try{for(var s,d=n()(this.roleList);!(l=(s=d.next()).done);l=!0){var c=s.value;if(c.roleId===e){if(c.authorityInfo[0].authorityName.toLowerCase()==="Admin".toLowerCase()){var u=this.authorityList,m=!0,h=!1,f=void 0;try{for(var v,g=n()(u);!(m=(v=g.next()).done);m=!0){var p=v.value;a.push(p.id.toString())}}catch(e){h=!0,f=e}finally{try{!m&&g.return&&g.return()}finally{if(h)throw f}}}else{var y=!0,_=!1,b=void 0;try{for(var C,M=n()(c.authorityInfo);!(y=(C=M.next()).done);y=!0){var k=C.value;a.push(k.authorityId)}}catch(e){_=!0,b=e}finally{try{!y&&M.return&&M.return()}finally{if(_)throw b}}}i=c.roleName}}}catch(e){o=!0,r=e}finally{try{!l&&d.return&&d.return()}finally{if(o)throw r}}this.initialLimit=a,this.initialRoleName=i,this.updateVisible=!0},handleUpdateOk:function(){var e=this;this.form.validateFields(function(t,a){if(!t){var i=e;e.$axios.patch("updateRole",{roleName:a.roleName,roleId:parseInt(e.currentRole.roleId),authorityIds:a.limit}).then(function(e){i.updateVisible=!1,i.initialLimit=[],i.initialRoleName="",i.currentRole={},0===e.data.retCode?i.getAllRole():(i.updateFailModal=!0,setTimeout(function(){i.updateFailModal=!1},3e3))})}})},handleUpdateCancel:function(e){this.initialLimit=[],this.initialRoleName="",this.updateVisible=!1},deleteRole:function(e){this.currentRole=e,this.deleteModal=!0},handleDeleteOk:function(){var e=this;this.$axios.patch("deleteRole",{id:parseInt(this.currentRole.roleId)}).then(function(t){e.deleteModal=!1,e.currentRole={},0===t.data.retCode?e.getAllRole():-1===t.data.retCode&&(e.deleteFailModal=!0,setTimeout(function(){e.deleteFailModal=!1},3e3))})},handleDeleteCancel:function(e){this.currentRole={},this.deleteModal=!1},getAllRole:function(){var e=this;this.$axios.get("getAllRoles").then(function(t){if(0===t.data.retCode){var a=t.data.info,i=!0,l=!1,o=void 0;try{for(var r,s=n()(a);!(i=(r=s.next()).done);i=!0){var d=r.value;d.roleCreateTime=e.$utils.getDate(d.roleCreateTime,!0)}}catch(e){l=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(l)throw o}}e.roleList=a,e.total=a.length}})},handlePageChange:function(){},getAllAuthorities:function(){var e=this;this.$axios.get("getAllAuthorities").then(function(t){if(0===t.data.retCode){for(var a=t.data.info,i=0;i<a.length;i++)a[i].authorityName.toLowerCase()==="Admin".toLowerCase()&&a.splice(i,1);e.authorityList=a}})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"role-management"},[a("top-bar",{staticClass:"top"},[a("div",{staticClass:"addAccount",attrs:{slot:"top-content"},on:{click:e.addRole},slot:"top-content"},[a("span",{staticClass:"iconfont iconzhuce"}),e._v("\n        "+e._s(e.$t("roleManagement.addRole"))+"\n      ")])]),e._v(" "),a("div",{staticClass:"list-content"},[a("a-table",{attrs:{"row-key":"roleId",columns:e.columns,"data-source":e.roleList,pagination:!1,tableLayout:"fixed",align:"center",rowClassName:function(e,t){var a="light-row";return t%2==1&&(a="dark-row"),a}},scopedSlots:e._u([{key:"action",fn:function(t,i){return[a("a-modal",{attrs:{destroyOnClose:!0,title:e.Title,visible:e.updateVisible,"confirm-loading":e.confirmLoading,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary",loading:e.confirmLoading},on:{click:function(t){return e.handleUpdateOk(i.roleId)}}},[e._v("\n                "+e._s(e.$t("roleManagement.confirm"))+"\n              ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleUpdateCancel}},[e._v("\n                "+e._s(e.$t("roleManagement.cancel"))+"\n              ")])],1),e._v(" "),a("a-form",{staticClass:"role-add",attrs:{form:e.form},on:{submit:e.handleUpdateCancel}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleName",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur",initialValue:e.initialRoleName}],expression:"[\n                    'roleName',\n                    {\n                      rules: [{ required: true, message: requireMessage }],\n                      validateTrigger: 'blur',\n                      initialValue: initialRoleName,\n                    },\n                  ]"}],attrs:{placeholder:e.rolenamePlaceholder,maxLength:30}})],1),e._v(" "),a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["limit",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur",initialValue:e.initialLimit}],expression:"[\n                    'limit',\n                    {\n                      rules: [{ required: true, message: requireMessage }],\n                      validateTrigger: 'blur',\n                      initialValue: initialLimit,\n                    },\n                  ]"}],attrs:{mode:"multiple",suffixIcon:e.downIcon,showArrow:!0,maxTagCount:1,placeholder:e.chooseLimit}},e._l(e.authorityList,function(t,i){return a("a-select-option",{key:i,attrs:{value:t.id.toString()}},[e._v("\n                    "+e._s(t.authorityName)+"\n                  ")])}),1)],1)],1)],2),e._v(" "),a("a-modal",{attrs:{destroyOnClose:!0,title:e.deleteTitle,visible:e.deleteModal,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary"},on:{click:function(t){return e.handleDeleteOk(i.roleId)}}},[e._v("\n                "+e._s(e.$t("roleManagement.confirm"))+"\n              ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleDeleteCancel}},[e._v("\n                "+e._s(e.$t("roleManagement.cancel"))+"\n              ")])],1),e._v(" "),a("div",{staticClass:"content"},[a("span",{staticClass:"iconfont iconziyuan13"}),e._v(" "),a("div",{staticClass:"p2"},[e._v("\n                "+e._s(e.$t("roleManagement.confirmDeleteRole"))+"\n              ")])])],2),e._v(" "),"Admin"!==i.roleName?a("div",[a("span",{staticClass:"edit",on:{click:function(t){return e.updateRole(i.roleId,i)}}},[e._v(e._s(e.$t("roleManagement.edit")))]),e._v(" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "),a("span",{staticClass:"delete",on:{click:function(t){return e.deleteRole(i)}}},[e._v(e._s(e.$t("roleManagement.delete")))])],1):e._e()]}},{key:"authority",fn:function(t,i){return e._l(i.authorityInfo,function(t,n){return a("span",{key:n},[e._v(e._s(t.authorityName)),n!=i.authorityInfo.length-1?a("span",[e._v("、")]):e._e()])})}}])})],1),e._v(" "),a("a-modal",{attrs:{destroyOnClose:!0,title:e.Title,visible:e.visible,"confirm-loading":e.confirmLoading,centered:!0,closable:!1,width:290}},[a("template",{slot:"footer"},[a("a-button",{key:"submit",staticClass:"modal-submit",attrs:{"html-type":"submit",type:"primary",loading:e.confirmLoading},on:{click:e.handleOk}},[e._v("\n          "+e._s(e.$t("roleManagement.confirm"))+"\n        ")]),e._v(" "),a("a-button",{key:"back",staticClass:"modal-cancel",on:{click:e.handleCancel}},[e._v("\n          "+e._s(e.$t("roleManagement.cancel"))+"\n        ")])],1),e._v(" "),a("a-form",{staticClass:"role-add",attrs:{form:e.form},on:{submit:e.handleOk}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleName",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur"}],expression:"[\n              'roleName',\n              {\n                rules: [{ required: true, message: requireMessage }],\n                validateTrigger: 'blur',\n              },\n            ]"}],attrs:{placeholder:e.rolenamePlaceholder,maxLength:30}})],1),e._v(" "),a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["limit",{rules:[{required:!0,message:e.requireMessage}],validateTrigger:"blur"}],expression:"[\n              'limit',\n              {\n                rules: [{ required: true, message: requireMessage }],\n                validateTrigger: 'blur',\n              },\n            ]"}],attrs:{mode:"multiple",suffixIcon:e.downIcon,showArrow:!0,maxTagCount:1,placeholder:e.chooseLimit}},e._l(e.authorityList,function(t,i){return a("a-select-option",{key:i,attrs:{value:t.id.toString()}},[e._v("\n              "+e._s(t.authorityName)+"\n            ")])}),1)],1)],1)],2),e._v(" "),a("a-modal",{staticClass:"deleteFail",attrs:{visible:e.deleteFailModal,centered:!0,closable:!1,width:288,footer:null}},[a("div",{staticClass:"deleteContent"},[a("span",{staticClass:"iconfont iconziyuan13"}),e._v(" "),a("div",[e._v(e._s(e.$t("roleManagement.roleUsing")))])])]),e._v(" "),a("a-modal",{staticClass:"deleteFail",attrs:{visible:e.updateFailModal,centered:!0,closable:!1,width:288,footer:null}},[a("div",{staticClass:"updateContent"},[a("span",{staticClass:"iconfont iconziyuan13"}),e._v(" "),a("div",[e._v(e._s(e.$t("roleManagement.roleExit")))])])])],1)])},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(e){a("oN/k")},"data-v-733ffe63",null);t.default=r.exports},VIxT:function(e,t,a){"use strict";var i={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"topBar"},[this._t("top-content")],2)},staticRenderFns:[]};var n=a("VU/8")({name:"",data:function(){return{}}},i,!1,function(e){a("MxJJ")},"data-v-01fba590",null);t.a=n.exports},"oN/k":function(e,t){}});